<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Resultado - ODS 13</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .result-box {
      max-width: 600px;
      margin: 80px auto;
      background: #ffffffcc;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;
      backdrop-filter: blur(8px);
    }
    .score {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .level {
      font-size: 22px;
      margin-bottom: 15px;
    }
    .message {
      font-size: 18px;
      line-height: 1.5;
    }
    .result-scroll {
      overflow-y: auto;
      max-height: 60vh;
      padding-right: 10px;
    }


  </style>
</head>
<body data-page="resultado">
  <div class="wrapper">
    <div class="side-image">
      <img src="assets/resultado.png" alt="Resultado Sustent√°vel">
    </div>

    <div class="result-box">
      <h2>Seu Resultado üåç</h2>

      <div class="result-scroll">
          <div id="result-content">
              <p class="score"></p>
              <p class="level"></p>
              <p class="message"></p>
          </div>
        <!-- As reflex√µes ser√£o inseridas aqui dinamicamente -->
      </div>

      <a href="index.html" class="btn" onclick="resetPage()">Voltar ao in√≠cio</a>
    </div>


    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // üîπ L√™ todos os dados salvos por p√°gina
        const data = JSON.parse(localStorage.getItem("sustentabilidade_por_pagina")) || {};

        const numericAnswers = [];
        const textAnswers = [];

        // üîπ Separa valores num√©ricos e textuais
        Object.values(data).forEach(arr => {
          arr.forEach(v => {
            if (typeof v === "string" && v.trim().length > 0) {
              textAnswers.push(v.trim());
            } else if (!isNaN(parseInt(v))) {
              numericAnswers.push(parseInt(v));
            }
          });
        });

        // üîπ Soma total de pontos dos selects
        let total = 0;
        numericAnswers.forEach(v => total += v);

        // üîπ Cada textarea preenchido vale 4 pontos (peso m√°ximo)
        const textPoints = textAnswers.length * 4;
        total += textPoints;

        // üîπ M√°ximo poss√≠vel = todos os selects * 4 + todos os textareas * 4
        const max = (numericAnswers.length + textAnswers.length) * 4;

        // üîπ Calcula a porcentagem
        const percent = max > 0 ? Math.round((total / max) * 100) : 0;

        // üîπ Define n√≠vel e mensagem
        let nivel = "";
        let msg = "";

        if (percent <= 40) {
          nivel = "üåæ Iniciante Verde";
          msg = "Voc√™ est√° come√ßando sua jornada sustent√°vel! Pequenas mudan√ßas far√£o uma grande diferen√ßa.";
        } else if (percent <= 70) {
          nivel = "üåø Consciente Ambiental";
          msg = "Voc√™ j√° demonstra bons h√°bitos e preocupa√ß√£o com o meio ambiente. Continue evoluindo!";
        } else if (percent <= 90) {
          nivel = "üå≥ Guardi√£o do Planeta";
          msg = "Excelente! Suas a√ß√µes sustent√°veis s√£o exemplo para outras pessoas.";
        } else {
          nivel = "üåé Her√≥i da Terra";
          msg = "Uau! Voc√™ vive de forma totalmente alinhada √† sustentabilidade. Continue inspirando o mundo!";
        }

        // üîπ Atualiza o resultado
        document.querySelector(".score").textContent = `Pontua√ß√£o: ${percent}%`;
        document.querySelector(".level").textContent = `N√≠vel: ${nivel}`;
        document.querySelector(".message").textContent = msg;

        console.log("Total:", total, "Max:", max, "Percent:", percent);
        console.log("Selects:", numericAnswers, "Textos:", textAnswers);

        // üîπ Exibe as respostas escritas
        if (textAnswers.length > 0) {
          const reflexaoDiv = document.createElement("div");
          reflexaoDiv.classList.add("reflexao-box");
          reflexaoDiv.innerHTML = `
            <h3>üå± Suas Reflex√µes</h3>
            <div class="reflexao-list">
              ${textAnswers.map(t => `
                <div class="reflexao-item">
                  <span class="aspas">‚ùù</span> ${t} <span class="aspas">‚ùû</span>
                </div>
              `).join("")}
            </div>
          `;
          document.querySelector(".result-scroll").appendChild(reflexaoDiv);
        }
      });
    </script>



    <script>
        document.addEventListener("DOMContentLoaded", () => {
        console.log("P√°gina:", window.location.pathname);
        console.log("P√°gina atual:", localStorage.getItem("actualPage"));
        console.log("Respostas atuais:", JSON.parse(localStorage.getItem("sustentabilidadeRespostas")));
        });
    </script>
</body>
</html>
